===========================================================================
【ソ フ ト名】　NCVC - NC(Gcode) Viewer and Converter Ver4.14
【登  録  名】　ncvc414.zip
【著作権  者】　眞柄　賢一
【対応  ＯＳ】　Windows 7 以降（全VerOSで動作確認したわけではありません）
【掲  載  日】　2024/03/11
【ソフト種別】　フリーソフト
【転載  条件】　事後でも連絡
===========================================================================

【ソフト紹介】
　一言で言うとフリー（無料）のＣＡＭソフトです。主な機能は以下の通り。

・２次元汎用ＣＡＤで製図した図形情報(DXF)から、ＮＣコードを生成。
　ＣＡＤはＤＸＦ出力可能、かつ、レイヤ名が出力できるものであれば、
　普段使い慣れたソフトでＯＫ！
・ＮＣコードの切削シミュレーション。
・ＮＣコードから各平面(XY,XZ,YZ)単位の２次元ＤＸＦデータ(R12形式)も出力可能。
・アドインＩ／Ｆによりユーザサイドの拡張。
　JW_CADデータ(JWW/JWC)が直接読み込めます。

一応基本的な機能は備えたつもりですが、まだまだ発展途上です。
いずれ「フリーでここまでできるのか！」というくらいまでは...(^o^)v


【ファイルリスト】
　ncvc414.zipには、次のファイルがあります。
NCVC.exe             ： 本体
Init.mnc             ： 機械情報のサンプル
Lathe.mnc            ： 機械情報のサンプル(旋盤)
Wire.mnc             ： 機械情報のサンプル(ワイヤ)
Init.nci             ： 切削条件ファイルのサンプル
Init.ncj             ： 旋盤データ生成用の切削条件ファイルサンプル
Init.ncw             ： ワイヤ放電加工機生成用の切削条件ファイルサンプル
Laser.nci            ： レーザ加工機用の切削条件ファイルサンプル
Deep.nci             ： 切削条件ファイルのサンプル２(深彫パラメータ)
Header.txt           ： NC生成のカスタムヘッダーファイル
Footer.txt           ： NC生成のカスタムフッダーファイル
HeaderLathe.txt      ： 旋盤用のカスタムヘッダーファイル
FooterLathe.txt      ： 旋盤用のカスタムフッダーファイル
HeaderWire.txt       ： ワイヤ放電用のカスタムヘッダーファイル
FooterWire.txt       ： ワイヤ放電用のカスタムフッダーファイル
HeaderLaser.txt      ： レーザ加工機用のカスタムヘッダーファイル
NCVCcolor.ini        ： お薦めカラーテーブル
---------------------------------------------------------------------
Gcode.txt            ： NCVC対応Ｇコード一覧表
GcodeLathe.txt       ： 　　〃　（旋盤モード差分）
GcodeWire.txt        ： 　　〃　（ワイヤ加工機モード差分）
Readme.txt           ： 本ファイル
sample\sample1.jww   ： サンプルのJW_CADファイル
sample\sample1.ncd   ： サンプルのNCコード
sample\deep.ncd      ： Deep.nciで処理したNCコード
sample\sample2.jww   ： 2.5D切削のサンプルJW_CADファイル
sample\sample2.ncl   ： sample2.jww用2.5D加工条件データ
sample\sample2.ncd   ： 2.5D切削のNCコード
sample\sample3.jww   ： 形状加工のサンプルJW_CADファイル
sample\sample3.cam   ： 形状加工のサンプルCAMファイル
sample\sample3.ncd   ： 形状加工のNCコード
sample\maizuru.jww   ： 文字サンプルのJW_CADデータ
sample\maizuru.ncd   ： 文字サンプルのNCコード
sample\lathe.jww     ： 旋盤モードのサンプルCADデータ
sample\lathe.ncd     ： 旋盤モードのサンプルNCコード
sample\wire_fig*.jww ： ワイヤ放電モードのサンプルCADデータ
sample\wire_fig*.cam ： ワイヤ放電モードのサンプルCAMファイル
sample\wire_fig*.ncd ： ワイヤ放電モードのサンプルNCコード
sample\NurbsDemo.igs ： NURBS曲面切削デモファイル
(※)
Ver0.14.00以降、アドインの同梱は廃止しました。最新のアドイン取得には
NCVCのホームページから必要な分をダウンロードしてください。
## インストーラバージョンはフルパッケージからインストールの選択が可能


【インストール】
　適当なディレクトリに解凍してください。
アドイン類はEXE本体と同じディレクトリに格納してください。
すでにインストールされている方は、
切削条件ファイルやカスタムヘッダーファイル等を上書きしない方がいいでしょう。
(使えるキーワードが増えている場合があるので、都度ご確認ください)
## インストーラバージョンは上書きインストールも可能
## 既に古いバージョンをインストール済みでも
## 「アプリケーションのインストールと削除」に複数掲載されることはありません。


【使用方法】
　ＮＣコードの切削シミュレーションは、ＮＣデータ(*.ncd)を開けば
その切削イメージが表示されます。表示色はカスタマイズ可能。
ＮＣデータ生成手順は以下の通り。

　　(1)ＣＡＤでの製図で、
　　　 ・切削したい線や円(弧)の軌跡、穴加工(実点or円)データを切削レイヤに
　　　 ・工作機械の原点を示す円(中心が工作機械の原点を表す)を原点レイヤに
　　　 ・上記２点は必須。必要に応じて加工開始時の移動パスを表す線or円は
　　　 　加工開始指示レイヤに、切削途中の強制移動指示は移動レイヤに
　　　 を作図。それぞれのレイヤに名前を設定してください。
　　　 以下はNCVCが読み込むデフォルトレイヤ名です。 

　　　　　切削レイヤ：CAM
　　　　　原点レイヤ：ORIGIN
　　　　　加工開始指示レイヤ　：デフォルトなし
　　　　　強制移動指示レイヤ　：デフォルトなし
　　　　　コメント用文字レイヤ：デフォルトなし

　　(2)ＤＸＦ形式で保存。ＤＸＦではそれぞれのＣＡＤ特有の情報が消える可能性が
　　　 あるので、念のためご使用のＣＡＤ独自の形式でも保存(JWW/DWG etc.)。

　　(3)NCVCでＤＸＦを開きます。正しく読むことが出来ればメニューから
　　　「ＮＣ変換」が選択できます。とりあえずそのままＯＫ

　　(4)生成されたＮＣデータがシミュレーションされます。

(3)にてデフォルトの切削条件(init.nci)を指定しましたが、もちろんそれぞれの加工
条件に合わせて設定してあげてください。切削条件ファイルはテキストファイルで保存
されますので、それぞれの加工条件にあった複数の条件ファイルを作っておくと効果的
です。
その他注意点として、

・現在のNCVCは軌跡切削なので使用する工具径を考慮しながら製図する必要がありま
　す。つまり輪郭加工やポケット加工を行う場合は、製図段階で複線による工具分の
　オフセット、または、ポケット加工を行うような軌跡を製図する必要があります。
　(*1)
・加工開始位置指示と強制移動指示のデータは必須ではありません。
　機械原点からの最短移動では工具が干渉してしまう、加工効率を上げるため早送り
　ポイントを指示したいなど、必要に応じて指定してください
・現在のＮＣコード生成エンジンは、基本的に２次元ＤＸＦデータを切削条件ファイル
　に従って３次元加工するだけのことですので、(まだ)Ｚ軸の動的な切削コントロール
　はできません(*2)。したがってネームプレート的な加工やワイヤー加工機などの２Ｄ
　切削に最適でしょう
・ＮＣデータ生成の探索ルールは、「一筆書き(オイラーグラフ)」を採用しています。
　出来るだけ同一Ｚ軸で一筆書き切削できるようなパスを生成(*3)しますが、まだそれ
　ほど賢くありません。あたたかく見守って下さい(^^;)

(*1)Ver1.00以降の形状認識処理を使えば、オフセット演算が可能になりました。
(*2)拡張ＮＣ生成機能（複数レイヤによる一括生成）を使えば、疑似2.5D切削
（等高線切削）も可能です。
(*3)端点での一筆書きのみ。交点での線分割は行いません

一度実行されると、ncd や cam の拡張子に関連づけされます。
関連づけされた後は、エクスプローラから
それぞれの拡張子をダブルクリックするだけで起動できます。
（エクスプローラからのＤ＆Ｄも可能）


【制限事項】
・対応するＧコードは Gcode.txt を参照してください。


【アンインストールについて】
　プログラム情報をレジストリに記録しています。
\HKEY_CURRENT_USER\Software\MNCT-S\NCVC を消去してください。
あと、.ncd と .cam 拡張子に関連づけされますので、それらも削除してください。
（レジストリエディタの検索で探せばでてきます）
## インストーラバージョンでインストールされた環境では、
## 「アプリケーションのインストールと削除」からアンインストール可能です


【再配布・商利用】
　再配布・ご利用に関して、次の条件を守ってください。
・基本的に再配布可能ですが、
  ・取得したアーカイバのまま配布
  ・事後でも連絡
・商用に関しては上記の条件に加え、
  ・NCVCをメインとするような商利用は厳禁
  ・NCVCをバンドルする場合でも、その商品のパッケージやマニュアル類などに
　　著作権表示と再配布条件を必ず明記すること
　ここでいう商用とは、NCVCがソフトウェアとして販売目的に用いられることを
　言います。NCVCの機能を用いて制作・加工した製品はこの限りではありません。


【著作権・知的所有権に関して】
　NCVC本体、および、それにまつわる各種成果物は
舞鶴工業高等専門学校教育研究支援センターの眞柄賢一が著作権を保有します。
アドインやスクリプトは各作者の著作物です。
著作権等を侵害するような行為は堅くお断りいたします。


【免責事項】
　本プログラム使用による損害等は作者は一切責任を持ちません。
特に生成したＮＣデータは加工前に厳重なチェックをお願いします。
また仕様変更義務も持ちませんが、これについてはもちろん良心的に対処します。
どしどし希望・要望をお寄せください。


【変更履歴】
4.13a → 4.14 への変更は
・NC表示
　：［トータル加工時間］を［トータル加工予想時間］とし，秒単位表記とした（Issue #19）

4.13 → 4.13a への変更は
・バグレポート
　：G02I_ などのような真円切削コードが表示されなかったバグを修正（Issue #18）
　：切削コードがないNCプログラムをシミュレーションさせるとOpenGLタブで異常終了するバグを修正

4.12c → 4.13 への変更は
・NC表示
　：NCコードのリスト表示（左側ペイン）で，
　　枠に収まらないブロックをマウスオーバーでブロック全体が表示されるようにした
・バグレポート
　：変換ツール等で生成したDXFを読み込むと，条件によってはNCVCが応答なしになるバグを修正（Issue #17）
　　→現実にはあり得ないような微細角度の円弧があると描画ループを抜けられなくなっていた

4.12b → 4.12c への変更は
・バグレポート
　：G91G00X_Y_M98P_ のようなブロックで，座標が2回加算されていたバグを修正（Issue #16）

4.12a → 4.12b への変更は
・バグレポート
　：Mコードのブロックにモーダルを想定した座標データがあると，その座標データが無視されていたバグを修正（Issue #15）
　：M98が（M30の直前など）最後にあると，トレース実行でNCVCが落ちるバグを修正

4.12 → 4.12a への変更は
・バグレポート
　：固定サイクルキャンセル(G80)のあとでG00〜G03のモーダルが効いていなかったバグを修正（Issue #14）

4.11 → 4.12 への変更は
・NC生成
　：生成したNURBS曲面のパスを消せるようになった
・NC表示
　：OpenGLレガシー関数であるglBegin()での描画を廃止（中身の話）
　　→描画効率が上がっています．（次のステージへの布石？）
・バグレポート
　：G91で作成したサブプログラムをM98呼び出しでトレース実行すると，
　　正しく描画されなかった（同じところを描画してしまう）バグを修正
　：特定の操作を行うとOpenGLのソリッド表示が出なくなるバグを修正

4.10 → 4.11 への変更は
・NC表示
　：リストを選択したら，該当する描画オブジェクトを選択色表示するようにした．
　　→トレース実行時にだけ有効になっていた機能ですが，それを常時機能するように変更．
　　　関連してトレース実行で行っていたトリッキーな描画方法をバッサリ削除（中身の話）
　：OpenGLタブでも線画によるトレース実行ができるようになった．
　　→ソリッド表示をオフにしてトレース実行すると何も表示されなくなる不具合対応．
・他
　：表示属性オプションの［トレース設定］にある［現在位置のマーカー表示］は削除．
　　→リスト選択からみで，このオプションは不要と判断しました．常に有効扱いとなります．
・バグレポート
　：ワイヤ放電加工機モードで，ソリッド表示をオフ（パス表示のみ）にしてトレース実行すると
　　NCVCが落ちるバグを修正．

4.00 → 4.10 への変更は
・NC生成
　：複数レイヤから［標準生成］するときの仕様を変更しました．
　　→標準生成は，"全てのデータからとにかく近いデータを検索" していましたが
　　　レイヤ名でソートし，同一レイヤ内での検索を優先するようにしました．
・NC表示
　：OpenGLタブの左ダブルクリック操作をメニュー操作に変更．
　　左ダブルクリック（線画の表示/非表示切り替え）は廃止しました．
　：OpenGLタブで描画された線をクリックすると，選択色になると同時に，
　　対応したブロック（行）が選択されるようにした．
　　→ワイヤ放電加工機モードのときは［ソリッド表示］をオフにしないと
　　　選択色が表示されません．
　：上記状態でTABキーを押すと，リストビューにフォーカスするようにした．
・バグレポート
　：コーナーRで向きが反対になるバグを修正（Issue #12）
　　→ただしもう少し検証が必要

3.91 → 4.00 への変更は（82,362行）
・NC生成
　：NURBS曲面の切削コードが吐けるようになった．
　　→詳細は別紙ドキュメント参照

過去の変更履歴および詳細は、
https://k-magara.github.io/ から更新履歴のリンクを参照してください。


【バグレポート】
　バグレポート及び要望・サポートなどは、『NCVCサポート掲示板』をご利用願います。

NCVCサポート掲示板
https://k-magara.github.io/
から「サポート掲示板」リンクをクリック

★★★★★★★★★★★★★★★★★★★★★★★★★★★★★★★★★★★★★
ヘルプが不備のため、後発の方への情報源として、できるだけ掲示板をご利用くだ
さい。既に質問内容とその解決策が掲示されているかもしれません。
念のため作者メールアドレスも記載していますが、メールでのお問い合わせには答
えられない場合もあります。
E-mail:magara[at]maizuru-ct.ac.jp
舞鶴工業高等専門学校　教育研究支援センター　眞柄　賢一 宛まで。
★★★★★★★★★★★★★★★★★★★★★★★★★★★★★★★★★★★★★


【謝辞】
　本プログラム作成にあたり、
・影ながら応援していただいている、
　またＣＡＤサンプル配布を快諾していただいた、
　(有)古谷工機　古谷 義博様
・スプラッシュウィンドウご提供の
　金田 誠輝様
・「円データによる穴加工」のアイデアを頂いた
　福岡 正幸様
・ワイヤー加工機での切削テストご協力の
　CBR1100XX 様
・NCVCcolor.ini 雛形ご提供の
　wistra 様
・さまざまな方面からの支援・援助いただいている
　本校教育研究支援センター技術職員
　　石井 貴弘様、能勢 嘉朗様
　京都大学工学研究科精密工学
　　佐藤 祐司様
　京都府立工業高等学校機械プランニング科
　　桂 延裕様
・NCVCテスターを始め、バリバリ使い込んでいる皆様(^^;)
各位には、この場を借りて感謝の意を表します。

なお、本プログラムの研究開発の一部は、
・平成12年度舞鶴工業高等専門学校重点研究費
・平成13年度日本学術振興会科学研究費補助金(奨励研究(B)No.13919089)
・平成21年度日本学術振興会科学研究費補助金(奨励研究No.21919030)
・平成25年度日本学術振興会科学研究費補助金(奨励研究No.25917025)
により遂行されたことを付記します。


【開発環境】
ＣＰＵ　　　：Core i7-10700K
メモリ　　　：16GB
ビデオ　　　：GeForce RTX 2070
ＯＳ　　　　：Windows 11 Enterprise(64bit)
開発環境　　：Visual Studio Professional/Community 2022
ライブラリ　：MFC, boost-1.84.0, GLEW-2.10, Kodatuno-R3.4改
　Kodatunoは、金沢大学マンマシン研究室で開発されている
　オープンソースCAMカーネルです
